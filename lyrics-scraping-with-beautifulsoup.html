<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Lyrics Scraping with BeautifulSoup</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="/lyrics-scraping-with-beautifulsoup.html" rel="canonical" />
  <!-- Feed -->

  <link href="/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="/theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="Data Scraping (a.k.a web scraping) is a technique of extracting information from a website. Researchers take to it when a website doesn’t provide an API. Before parsing data from any site, you must read the rules for using the content presented on the site. There are no strict legal procedures, but sites can have their own policies and prohibit certain actions or block users who violate the rules.">

    <meta name="author" content="nova">

    <meta name="tags" content="Data Scraping">
    <meta name="tags" content="Data Parsing">
    <meta name="tags" content="requests">
    <meta name="tags" content="BeautifulSoup">




<!-- Open Graph -->
<meta property="og:site_name" content="novamind"/>
<meta property="og:title" content="Lyrics Scraping with BeautifulSoup"/>
<meta property="og:description" content="Data Scraping (a.k.a web scraping) is a technique of extracting information from a website. Researchers take to it when a website..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="/lyrics-scraping-with-beautifulsoup.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-02-06 00:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="/author/nova.html">
<meta property="article:section" content="Review"/>
<meta property="article:tag" content="Data Scraping"/>
<meta property="article:tag" content="Data Parsing"/>
<meta property="article:tag" content="requests"/>
<meta property="article:tag" content="BeautifulSoup"/>
<meta property="og:image" content="/images/bg.jpg">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Lyrics Scraping with BeautifulSoup",
  "headline": "Lyrics Scraping with BeautifulSoup",
  "datePublished": "2021-02-06 00:00:00+01:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "nova",
    "url": "/author/nova.html"
  },
  "image": "/images/bg.jpg",
  "url": "/lyrics-scraping-with-beautifulsoup.html",
  "description": "Data Scraping (a.k.a web scraping) is a technique of extracting information from a website. Researchers take to it when a website..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>

              <li role="presentation"><a href="/pages/valentina-kononova.html">Valentina Kononova</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Lyrics Scraping with BeautifulSoup</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="/author/nova.html">Valentina Kononova</a>
            | <time datetime="Сб 06 февраля 2021">Сб 06 февраля 2021</time>
        </span>
        <!-- TODO : Modified check -->
            <div class="post-cover cover" style="background-image: url('/images/bg.jpg')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <h2>Data Scraping</h2>
<p>Data Scraping (a.k.a web scraping) is a technique of extracting information from a website. Researchers take to it when a website doesn’t provide an API.
Before parsing data from any site, you must read the rules for using the content presented on the site. There are no strict legal procedures, but sites can have their own policies and prohibit certain actions or block users who violate the rules.
Moreover, if the server receives a number of requests that exceed its bandwidth, it will not be able to process them and will throw an error. Therefore, be careful and optimize your script before running it.</p>
<h2>BeautifulSoup</h2>
<p>We’ll use the most popular python libraries for data scraping and parsing: <code>requests</code> and <code>BeautifulSoup</code>.
The requests module allows us to make HTTP requests, which returns the content of the website as an HTML document.</p>
<p>BeautifulSoup is often used for parsing HTML documents. It converts the document into a tree of objects such as BeautifulSoup, tag, navigable string. 
BeautifulSoup object contains the nested html tags (body, div, p, etc) and we can find a tag with specific parameters that contains the information we are looking for.</p>
<p>You can find more details at <a href="https://requests.readthedocs.io/en/master/">requests</a> and <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#kinds-of-objects">BeautifulSoup</a>.</p>
<h2>Specificity of AZlyrics</h2>
<p>We will consider the lyrics scraping from AZlyrics as it provides a huge number of song lyrics of different artists and genres. AZlyrics does not allow the content to be used by other lyrics providers, so if you are a provider, do not run the script :)</p>
<p>Let’s go to an artist (for instance: <a href="https://www.azlyrics.com/m/mileycyrus.html">Miley Cyrus</a>) and look at how the information is structured on the website (right-click Inspect to find the code). </p>
<p>In Elements we can see a tree of html tags. Tags have properties and attributes. The most commonly used properties during the document parsing are <code>class</code> and <code>id</code>. The id value is unique for the entire document, but several components can have the same class name. These properties help us to find the certain tag. Using the <code>text</code> attribute we can get the text between the opening and closing tags. The <code>attrs</code> returns a dictionary of attributes that are inside the tag (for instance, a.attrs[‘href’] returns a link from <code>&lt;a&gt;</code> tag). </p>
<p><img alt="Artist Page" src="images/artistpage.png"></p>
<figcaption>Songs containers</figcaption>

<p>The page of the artist contains a list of his albums and songs, which are at the same level in the HTML document - song containers are not nested in the album container. Each container with <code>class=”listalbum-item”</code> contains the name of the songs and a link to the lyrics inside the <code>&lt;a&gt;</code> tag. We can follow the link and see that the text is in <code>&lt;div&gt;</code>, which hasn’t a specific class or id, but it’s involved in the parent container with <code>class="col-xs-12 col-lg-8 text-center"</code>, so we can easily extract the text.</p>
<p><img alt="Artist Page" src="images/songpage.png"></p>
<figcaption>Lyrics container</figcaption>

<h2>Data extraction</h2>
<p>There are several steps we are going to follow.</p>
<p><strong>Parse the content of the initial url</strong></p>
<p>To scrape the data from the website we will use <code>requests</code> library with a link to the artist page.</p>
<div class="highlight"><pre><span></span><code><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.azlyrics.com/m/mileycyrus.html&#39;</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Parse the content of the songs pages</strong></p>
<p>Go through the list of song containers and construct the full link to the lyric, as the <code>&lt;a&gt;</code> contains relative link:</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;.listalbum-item&#39;</span><span class="p">):</span>
    <span class="n">s_link</span> <span class="o">=</span> <span class="s1">&#39;https://www.azlyrics.com&#39;</span> <span class="o">+</span> <span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Extract the content of the song page and parse the document:</p>
<div class="highlight"><pre><span></span><code><span class="n">s_page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s_link</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
<span class="n">page_content</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">s_page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
</code></pre></div>

<p>Select the container with the <code>class=”col-xs-12.col-lg-8.text-center”</code> and pull the lyrics:</p>
<div class="highlight"><pre><span></span><code><span class="n">s_text</span> <span class="o">=</span> <span class="n">page_content</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;.col-xs-12.col-lg-8.text-center&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

<p>Get album information, including its title, year of realise (check if there is an album, because some releases do not involved into any album):</p>
<div class="highlight"><pre><span></span><code><span class="n">lyrics</span> <span class="o">=</span> <span class="n">page_content</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;.col-xs-12.col-lg-8.text-center&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">album</span> <span class="o">=</span> <span class="n">page_content</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s1">&#39;.songinalbum_title&#39;</span><span class="p">)</span>
<span class="n">album_details</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">album_title</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">if</span> <span class="n">album</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">album_details</span> <span class="o">=</span> <span class="n">album</span><span class="o">.</span><span class="n">text</span>
    <span class="n">album_title</span> <span class="o">=</span> <span class="n">album</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">text</span>
</code></pre></div>

<p>Add a dictionary containing the song title, its lyrics and album information to dataset:</p>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
    <span class="s1">&#39;album_info&#39;</span><span class="p">:</span> <span class="n">album_details</span><span class="p">,</span> 
    <span class="s1">&#39;album_title&#39;</span><span class="p">:</span> <span class="n">album_title</span><span class="p">,</span>
    <span class="s1">&#39;lyrics&#39;</span><span class="p">:</span> <span class="n">lyrics</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
    <span class="s1">&#39;song_title&#39;</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span>
<span class="p">})</span>
</code></pre></div>

<p>Multiple requests can overload the server and it can affect its functioning. Moreover, requests to the server with the same IP address can cause a ban of the user, as it may be recognized as suspicious actions. 
We can solve it by using a custom user agent and adding a delay in every loop: <code>time.sleep(15)</code>.</p>
<p>Now we have a list of lyrics, which can be saved in any format that fit the data processing task.</p>
<p>The code is available on <a href="https://github.com/novamind/dataparsing">GitHub</a>. Feel free to open pull requests.</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Lyrics Scraping with BeautifulSoup&amp;url=/lyrics-scraping-with-beautifulsoup.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=/lyrics-scraping-with-beautifulsoup.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=/lyrics-scraping-with-beautifulsoup.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="/tag/data-scraping.html">Data Scraping</a><a href="/tag/data-parsing.html">Data Parsing</a><a href="/tag/requests.html">requests</a><a href="/tag/beautifulsoup.html">BeautifulSoup</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src="/images/bio.jpg" alt="Valentina Kononova" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="/author/nova.html">Valentina Kononova</a></h4>
                            <p class="post-author-about">Master of Science with 2 years of international experience in natural language processing. Designed and deployed a variety of models using advanced AI/ML algorithms.</p>
                            <span class="post-author-location"><i class="ic ic-location"></i> Russia</span>
                        <!-- Social linkes in alphabet order. -->
                            <span class="post-author-github"><a target="_blank" href="https://github.com/novamind"><i class="ic ic-link"></i> GitHub</a></span>
                            <span class="post-author-linkedin"><a target="_blank" href="https://www.linkedin.com/in/valentina-kononova-a9a23b180"><i class="ic ic-link"></i> LinkedIn</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="/theme/js/script.js"></script>

</body>
</html>